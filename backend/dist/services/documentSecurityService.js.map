{"version":3,"file":"documentSecurityService.js","sourceRoot":"","sources":["../../src/services/documentSecurityService.ts"],"names":[],"mappings":"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"}